<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="true" />

<title>Mixed models and autocorrelation</title>

<!-- HEAD_CONTENT -->

<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->



</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<div id="section-week-11-mixed-models-and-autocorrelation"
class="section level1">
<h1><strong>Week 11:</strong> Mixed models and autocorrelation</h1>
<div id="section-anth-674-research-design-and-analysis-in-anthropology"
class="section level4">
<h4>ANTH 674: Research Design and Analysis in Anthropology</h4>
</div>
<div id="section-professor-andrew-du" class="section level4">
<h4>Professor Andrew Du</h4>
</div>
<div id="section-introduction" class="section level2">
<h2>Introduction</h2>
<p>This week, we covered two different but somewhat related topics:
linear mixed models and autocorrelation. <strong>Linear mixed
models</strong> (LMMs) model a (continuous or categorical) DV as a
linear function of <strong>fixed</strong> and <strong>random
factors</strong> (also known as fixed and random effects). <strong>Fixed
factors</strong> are categorical variables whose levels are the only
ones of interest. Therefore, we estimate coefficients for the different
levels because we are interested in how the intercept and/or slope of
the DV against another IV changes with each level in our fixed factor.
<strong>Random factors</strong> are categorical variables whose levels
are a random, representative sample of some larger population of levels.
Therefore, we are not interested in estimating coefficients for each
level but instead want to infer something about the population of
intercepts/slopes from which our levels are sampled. A utilitarian
perspective can help with determining whether your factor is fixed or
random: do you want to estimate coefficients for each level or do you
want to estimate the SD of the population of intercepts/slopes from
which your levels are sampled? As always, the distinction depends on
your research question!</p>
<p><img
src="https://hlplab.files.wordpress.com/2011/05/simpsons-paradox.png?w=1410"
style="width:75.0%" /></p>
<p>The second topic we covered was how to measure and deal with
autocorrelation in your analyses. As a reminder,
<strong>autocorrelation</strong> is simply non-independence in your
data, where data points closer in space/time/phylogeny are more similar.
Autocorrelation is somewhat related to LMMs because one can specify
blocking factors as random effects to account for autocorrelation in
LMMs. What we specifically covered was how to isolate the autocorrelated
noise component in one’s data through detrending. We also covered how to
measure autocorrelation in the data using correlograms. Lastly, we went
over how to measure the association between two variables in time and
space using cross-correlograms and generalized least squares.</p>
<p><img
src="https://www.influxdata.com/wp-content/uploads/autocorrelation-in-time-series-data-figure-5.png"
style="width:75.0%" /></p>
<p>In this tutorial, we will cover how to do all of the above in R.
Where necessary, we will do some simple simulations to really make clear
how some of these methods and concepts work. At the end of the tutorial,
you should be able to run basic LMMs and know how to handle
autocorrelation in your own research.</p>
</div>
<div id="section-goals-for-this-tutorial" class="section level2">
<h2>Goals for this tutorial</h2>
<div
id="section-continue-the-never-ending-journey-of-familiarizing-yourself-with-r."
class="section level4">
<h4>1) Continue the never-ending journey of familiarizing yourself with
R.</h4>
</div>
<div id="section-know-when-to-specify-a-factor-as-fixed-or-random."
class="section level4">
<h4>2) Know when to specify a factor as fixed or random.</h4>
</div>
<div id="section-learn-how-to-run-a-lmm-in-r." class="section level4">
<h4>3) Learn how to run a LMM in R.</h4>
</div>
<div id="section-learn-how-to-do-variance-partitioning-with-lmms."
class="section level4">
<h4>4) Learn how to do variance partitioning with LMMs.</h4>
</div>
<div
id="section-learn-what-the-three-components-of-temporal-and-spatial-and-phylogenetic-data-are-and-how-to-isolate-autocorrelated-noise."
class="section level4">
<h4>5) Learn what the three components of temporal and spatial (and
phylogenetic data are) and how to isolate autocorrelated noise.</h4>
</div>
<div
id="section-learn-how-to-do-correlograms-cross-correlograms-and-generalized-least-squares-in-r."
class="section level4">
<h4>6) Learn how to do correlograms, cross-correlograms, and generalized
least squares in R.</h4>
</div>
</div>
<div id="section-random-factors" class="section level2">
<h2>Random factors</h2>
<p>I briefly defined random factors in the <em>Introduction</em>, but I
find the best way to learn what a random factor is is through
simulations.</p>
<div id="section-random-intercept-model" class="section level3">
<h3>Random intercept model</h3>
<p>As I mentioned in the <em>Introduction</em>, one specifies a factor
as random if one is interested in estimating the SD of the population of
intercepts or slopes from which the levels are sampled. Let’s see how
this works by first simulating data and then estimating the population
SD of the intercepts across levels using LMMs.</p>
<p>One can think of a random factor as an extra term added to the
intercept:</p>
<p><span class="math display">\[\begin{align}
  Y = \beta_0 + \alpha + \beta_1 X + \epsilon,
\end{align}\]</span></p>
<p>where <span class="math inline">\(\alpha \sim N(0, \tau)\)</span>.
That is, <span class="math inline">\(\alpha\)</span> is a random factor
that is normally distributed with mean zero and SD equal to <span
class="math inline">\(\tau\)</span>. So each level within a random
factor is associated with a number drawn from this normal distribution
that tells us by how much that level’s intercept deviates from the main
estimated intercept (a fixed effect). This SD (<span
class="math inline">\(\tau\)</span>) is the parameter estimated in a
LMM, and hopefully you can now see why levels from a random factor are
associated with some population, whose SD (<span
class="math inline">\(\tau\)</span>) we want to estimate.</p>
<p>Below is the code to simulate the data, with comments on what each
line is doing (code adapted from <a
href="https://m-clark.github.io/mixed-models-with-R/random_intercepts.html">here</a>).
After you get somewhat of a handle of what’s going on, copy and paste
the code into the console below.</p>
<pre class="r"><code>intercept_SD &lt;- 0.5 # setting SD of population of intercept deviations
e_SD &lt;- 0.25 # setting SD of population of error terms

set.seed(1234) # to make simulations replicable
Nlevels &lt;- 100 # number of levels within the random factor
NperLevel &lt;- 5 # number of observations per level
N &lt;- Nlevels * NperLevel # total number of observations
Levels &lt;- factor(rep(1:Nlevels, each = NperLevel)) # create factor level associated with each observation
a &lt;- rnorm(Nlevels * NperLevel, sd = intercept_SD) # simulate random draws from normal distribution of intercepts (specifically, deviations from main intercept)
e &lt;- rnorm(N, sd = e_SD) # simulate error terms
x &lt;- runif(N) # simulate IV
y &lt;- 2 + .5 * x + a[Levels] + e # simulate DV, fixed intercept (2), fixed slope (0.5), add random factor, and add error terms

d = data.frame(x, y, Levels) # combine everything into one dataframe</code></pre>
<div class="tutorial-exercise" data-label="intercept"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>Now fit a LMM to the data. This is done using <code>lme()</code> from
the <code>nlme</code> package. The proper line of code is
<code>lmm.res &lt;- lme(y ~ x, random = ~1|Levels, data = d)</code>. The
<code>random = ~1|Levels</code> tells R that we want to estimate the SD
of intercepts (<code>~1</code>) across levels within the factor
<code>Levels</code>. Enter the code above.</p>
<p>Now enter <code>summary(lmm.res)</code> to see the full suite of
results. First you’ll see that the estimated SD for the intercept is
0.5, precisely what we set the population SD to be. The Residual SD is
0.24, close to the 0.25 we specified. The intercept and slope are 1.9
and 0.53, close to the values we picked. And lastly, you can see the
fixed effects (intercept and slope) are significant; we can get P-values
for simple LMMs like this one but not for more complicated LMMs (which
can’t be run using <code>lme()</code>).</p>
<p><strong>NB:</strong> A P-value can be vanishingly small but can never
be zero. Zero in this case is synonymous with P &lt; 0.0001 (you can see
this if you enter <code>anova(lmm.res)</code>).</p>
<p>We can also get out the deviations (from the main intercept) for each
level sampled from the population. This is done with
<code>ranef(lmm.res)</code>, which returns the result as a dataframe
(this is also how you plot each level’s lines on a scatter plot). Enter
<code>hist(ranef(lmm.res)[, 1])</code> to see the distribution sampled
from the population. Because we have 100 levels, a sizable sample size,
the mean and SD of <code>ranef(lmm.res)[, 1]</code> should be very close
to the population mean and SD (0 and 0.5, respectively).</p>
</div>
<div id="section-random-intercept-and-slope-model"
class="section level3">
<h3>Random intercept and slope model</h3>
<p>To finish out this section, we will simulate another set of data,
this time for a random intercept <em>and</em> slope model. This equation
is now:</p>
<p><span class="math display">\[\begin{align}
  Y = \beta_0 + \alpha_0 + (\beta_1 + \alpha_1) X + \epsilon,
\end{align}\]</span></p>
<p>where <span class="math inline">\(\alpha_0 \sim N(0, \tau_0)\)</span>
and <span class="math inline">\(\alpha_1 \sim N(0, \tau_1)\)</span>.
<span class="math inline">\(\alpha_0\)</span> and <span
class="math inline">\(\tau_0\)</span> are <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\tau\)</span> from above, respectively, and <span
class="math inline">\(\alpha_1\)</span> is a random factor that is
normally distributed with mean zero and SD equal to <span
class="math inline">\(\tau_1\)</span>. <span
class="math inline">\(\alpha_1\)</span> is the population of each
level’s deviation from the fixed slope effect.</p>
<p>Below is the proper code with comments. Review it and then copy and
paste it into the console below.</p>
<pre class="r"><code>intercept_SD &lt;- 0.75 # setting SD of population of intercept deviations
slope_SD &lt;- 0.25 # setting SD of population of slope deviations
e_SD &lt;- 0.25 # setting SD of population of error terms

set.seed(1234) # to make simulations replicable
Nlevels &lt;- 100 # number of levels within the random factor
NperLevel &lt;- 5 # number of observations per level
N &lt;- Nlevels * NperLevel # total number of observations
Levels &lt;- factor(rep(1:Nlevels, each = NperLevel)) # create factor level associated with each observation
a_0 &lt;- rnorm(Nlevels * NperLevel, sd = intercept_SD) # simulate random draws from normal distribution of intercepts (specifically, deviations from main intercept)
a_1 &lt;- rnorm(Nlevels * NperLevel, sd = slope_SD) # simulate random draws from normal distribution of slopes (specifically, deviations from main slope)
e &lt;- rnorm(N, sd = e_SD) # simulate error terms
x &lt;- runif(N) # simulate IV
y &lt;- (2 + a_0[Levels]) + (.5 + a_1[Levels]) * x + e # simulate DV, fixed intercept (2), fixed slope (0.5), add random factors, and add error terms

d = data.frame(x, y, Levels) # combine everything into one dataframe</code></pre>
<div class="tutorial-exercise" data-label="slope" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>Fit the LMM with
<code>lmm.res1 &lt;- lme(y ~ x, random = ~x | Levels, data = d)</code>.
The <code>random = ~x | Levels</code> tells R that we want the estimate
the SD of deviations for the slope across the factor <code>Levels</code>
(the intercept is implied, just like it is when you use
<code>lm()</code>).</p>
<p>Compare the estimated parameters with those you specified (i.e., main
intercept, main slope, intercept SD, slope SD, and residual SD).</p>
<p>As before, you can get out each level’s deviations for the intercept
and slope using <code>ranef()</code>.</p>
<p><strong>NB:</strong> I don’t go over how to do this, but you can fit
<em>generalized linear mixed models</em> using <code>glmer()</code> in
the <code>lme4</code> package. There is just one extra argument,
<code>family =</code>, which you use to specify the error distribution
(e.g., <code>family = "binomial"</code> would fit a logistic regression
mixed model).</p>
</div>
</div>
<div id="section-comparing-ancova-and-lmm" class="section level2">
<h2>Comparing ANCOVA and LMM</h2>
<p>Comparing the goals and results of ANCOVA to LMM will also make
clearer when one would make a factor random rather than fixed.</p>
<p>For this section, we will use the <code>sleepstudy</code> dataset in
the <code>lme4</code> package. Enter <code>?sleepstudy</code> to get an
idea of what the dataset and variables therein are.</p>
<p>Let’s fit an ANCOVA with an interaction term to see see how the
intercept and slope of <code>Reaction ~ Days</code> change as a function
of the levels within <code>Subject</code>.</p>
<div class="tutorial-exercise" data-label="ancova" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button if stuck</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ancova-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>ancova.res &lt;- lm(Reaction ~ Days * Subject, data = sleepstudy)

lmm.res &lt;- lme(Reaction ~ Days, random = ~Days | Subject, data = sleepstudy)</code></pre>
</div>
<p>As you can see, a total of 36 coefficients were estimated, two for
each subject (intercept and slope)! This would be fine if the subjects
were of interest for whatever reason, and we wanted to know what their
estimated intercepts and slopes were. But, we only have 180 data points,
which means we have 5 data points per estimated coefficient (we are
definitely overfitting the data!).</p>
<p>A LMM, on the other hand, would estimate only two fixed effects
(intercept and slope) and two other parameters (one SD each for the
populations of intercept and slope deviations). Go ahead and fit the
LMM.</p>
<div id="section-shrinkageregularization" class="section level3">
<h3>Shrinkage/regularization</h3>
<p>At this point, feel free to compare the estimated slope and intercept
for each level for an ANCOVA vs. a LMM. Remember that each level’s
intercept in an ANCOVA is obtained by adding the baseline intercept to
that level’s main effect (e.g., to get the intercept for
<code>Subject309</code> add <code>244.193</code> with
<code>-39.138</code>). To get the level’s slope, add the baseline slope
to that subject’s interaction term (e.g., to get the slope for
<code>Subject309</code>, add <code>21.765</code> with
<code>-19.503</code>). To get a level’s intercept and slope from a LMM,
you just add the deviation to its respective fixed effect
(<code>Subject309</code>’s intercept is <code>251.405</code> plus
<code>-40.398</code>). Recall that you extract the deviations using
<code>ranef(lmm.res)</code>.</p>
<div class="tutorial-exercise" data-label="shrink" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>As you’ll see, the LMM’s intercept and slope will be closer to their
fixed counterparts (i.e., their averages) than those from ANCOVA; recall
that the LMM’s fixed effects are the same as the intercept and slope if
a linear model was fit without including <code>Subject</code>. This
phenomenon is know as <strong>shrinkage</strong> or
<strong>regularization</strong>. Because each level’s intercept
deviation, for example, is sampled from a population with mean 0,
levels’ intercepts are expected to be close to zero on average.
Therefore, each level’s deviation will be pulled towards zero (i.e.,
each level’s intercept will be pulled towards the fixed intercept
effect). If a level has few observations, its deviations will be pulled
more towards zero (i.e., with little data, the best guess we can make is
the average). Because of this shrinkage property, some researchers argue
that one should <em>always</em> use a LMM as opposed to an ANCOVA, but
this debate is beyond my pay grade.</p>
<div class="figure">
<img
src="https://www.tjmahr.com/figs//2017-06-22-plotting-partial-pooling-in-mixed-effects-models/shrinkage-plot-1.png"
style="width:75.0%" alt="" />
<p class="caption">“No pooling” is the ANCOVA estimates, “Partial
pooling” is the LMM estimates, and “Partial pooling (average)” is the
fixed effect estimates.</p>
</div>
</div>
<div id="section-a-note-on-blocking" class="section level3">
<h3>A note on blocking</h3>
<p>Multiple measurements were taken on each subject over time. This is
known as a <strong>repeated measures design</strong>. Because of this,
each subject’s measurements are not independent. By including
<code>Subject</code> as a random factor, however, we have effectively
used this variable as a blocking factor. This accounts for the
non-independent data for each subject. Fitting an ANCOVA does the same
thing, but that’s inappropriate here because we don’t have a large
enough sample size.</p>
</div>
</div>
<div id="section-variance-partitioning" class="section level2">
<h2>Variance partitioning</h2>
<p>When one has multiple random factors within a LMM, one can do
<strong>variance partitioning</strong> and see how much DV variation
(not accounted for by the fixed effects) is attributable to each random
factor. More interestingly, one can fit an intercept-only LMM and see
how the DV variation is partitioned among the random factors.</p>
<div id="section-crossed-random-factors" class="section level3">
<h3>Crossed random factors</h3>
<p>Random factors are <strong>crossed</strong> if each level within a
factor is combined with each level from the other factor. We will
analyze the crossed factors (<code>plate</code> and <code>sample</code>)
from the <code>Penicillin</code> dataset from the package
<code>lme4</code> for this section.</p>
<p>Enter <code>?Penicillin</code> to get an idea of what the dataset and
variables are.</p>
<div class="tutorial-exercise" data-label="cross" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>I entered the following code to make the summary plot from lecture
(<code>dotplot()</code> is from the package <code>lattice</code>):</p>
<pre class="r"><code>dotplot(reorder(plate, diameter) ~ diameter, Penicillin, groups = sample, ylab = &quot;Plate&quot;, xlab = &quot;Diameter of growth inhibition zone (mm)&quot;, type = c(&quot;p&quot;, &quot;a&quot;), auto.key = list(columns = 3, lines = TRUE, title = &quot;Penicillin sample&quot;), cex = 1.5)</code></pre>
<p>One can see that <code>diameter</code> varies a decent amount across
plates (<code>plate</code>), but most of the variation is across
penicillin samples (<code>sample</code>). Let’s fit an intercept-only
LMM to quantify how much <code>diameter</code> variation is attributed
to each random factor (i.e., <code>plate</code> and
<code>sample</code>).</p>
<p>Fitting a LMM with crossed random factors is difficult to do with
<code>lme()</code>. This is where LMMs start to become complicated, and
we have to switch to the <code>lmer()</code> function in the
<code>lme4</code> package. To fit a LMM with crossed random factors
using <code>lmer()</code>, enter
<code>lmer(diameter ~ 1 + (1 | plate) + (1 | sample), data = Penicillin)</code>.
The <code>(1 | plate) + (1 | sample)</code> is telling R that we want
our intercept to vary across <code>plate</code> levels and
<code>sample</code> levels.</p>
<p>The main difference using <code>lmer()</code> is that no P-values are
returned. This is not an accident, as P-values cannot be estimated
accurately with complex LMMs.</p>
<p>We now need to get out the variances. This is done using
<code>VarCorr()</code>, but the output is a bit annoying to work with. I
find it’s easier to transform the output using
<code>as.data.frame()</code>, so enter
<code>as.data.frame(VarCorr(lmm.res))</code>. The column we want is
<code>vcov</code>. You can now interpret those variances as is, but I
find it’s more useful to transform them into proportion variance
explained by dividing each element in the column by the column’s sum. As
we can see, the majority of the <code>diameter</code> variance is
explained by <code>sample</code>, matching our intuition from the dot
plot.</p>
</div>
<div id="section-nested-random-factors" class="section level3">
<h3>Nested random factors</h3>
<p><strong>Nested random factors</strong> are those whose factors are
nested within each other (like Russian nesting dolls). Examples include
species nested within genera, hospitals nested within cities nested
within states, etc.</p>
<p><img
src="https://www.vermontcountrystore.com/ccstore/v1/images/?source=/file/v1572392947014410569/products/70072.main.png&amp;height=700&amp;width=450&amp;outputFormat=JPEG&amp;quality=0.8"
style="width:40.0%" /></p>
<p>For this section, we will use the <code>Pastes</code> dataset from
the <code>lme4</code> package. See the help file for a description of
the dataset.</p>
<p>There are a total of 10 batches (<code>batch</code>), three casks
(<code>cask</code>) per batch, and researchers tested the paste strength
(<code>strength</code>) of two samples (<code>sample</code>) per
cask.</p>
<p>Here is a summary plot of the data (which I pulled from a paper, so
no code):</p>
<p><img
src="https://github.com/andrewdu1/ANTH674/blob/master/Datasets/Pastes%20summary%20plot.jpg?raw=true"
style="width:75.0%" /></p>
<p>As you can see from the dataset and the figure, levels from
<code>sample</code> are a combination of <code>batch</code> and
<code>cask</code>. This is necessary so that we know, for example, that
samples of <code>A:a</code> are associated with cask <code>a</code> from
batch <code>A</code>, as opposed to batch <code>B</code>.</p>
<p>A nested random factors LMM is fit using the same exact code as with
crossed factors:
<code>lmer(strength ~ 1 + (1 | sample) + (1 | batch), data = Pastes)</code>.
This emphasizes how random factors’ variances are calculated in the same
exact way, regardless of whether the factors are crossed or nested. You
can also do nested random factors using <code>lme()</code>:
<code>lme(strength ~ 1, random = ~1 | batch / sample, data=Pastes)</code>.
The <code>/</code> indicates that <code>sample</code> is nested within
<code>batch</code> (this symbol also works for <code>lmer()</code>,
e.g.,
<code>lmer(strength ~ 1 + (1 | batch / sample), data = Pastes)</code>).</p>
<div class="tutorial-exercise" data-label="nest" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>The variance components are pulled out in the same exact way as
before when using <code>lmer()</code>. Variance components can be
extracted from an <code>lme()</code> result using <code>varcomp</code>
in the package <code>ape</code> (so many different packages in this
tutorial!). Enter <code>varcomp(lme.res)</code> to try it out. You can
also set argument <code>scale = TRUE</code> to get out proportion
variance explained. As you can see, most of the variance in
<code>strength</code> is among casks (<code>sample</code>), rather than
among <code>batch</code> or within <code>sample</code>.</p>
</div>
</div>
<div id="section-exercise-1" class="section level2">
<h2>Exercise 1</h2>
<ol style="list-style-type: decimal">
<li><p>We’re going to use the <code>gpa</code> dataset, which I’ve
pre-loaded for you. I want to know the SD of the intercept and slope of
GPA (<code>gpa</code>) as a function of semester (<code>occasion</code>)
across levels within <code>student</code>. Fit the appropriate
LMM.</p></li>
<li><p>We’re going to use the <code>nurses</code> dataset, which I’ve
pre-loaded for you. I want to know how the variance in nurses’ stress
(<code>stress</code>) is partitioned among <code>wardid</code>, which is
nested within <code>hospital</code>. Get out the variance components to
see if variation in stress is mostly explained by variation between
hospitals, between wards, or within wards.</p></li>
</ol>
<div class="tutorial-exercise" data-label="exer1" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button when done
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="exer1-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>gpa_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/gpa.csv&quot;)
gpa &lt;- read.csv(text = gpa_url)

nurses_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/nurses.csv&quot;)
nurses &lt;- read.csv(text = nurses_url)</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="exer1-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code># Q1
gpa_lmm &lt;-  lmer(gpa ~ occasion + (occasion | student), data = gpa)
# or
gpa_lmm1 &lt;-  lme(gpa ~ occasion, random = ~occasion | student, data = gpa)

# Q2
nurses_nest &lt;- lmer(stress ~ 1 + (1 | hospital) + (1 | wardid), data = nurses)

var.comp &lt;-as.data.frame(VarCorr(nurses_nest))$vcov
var.comp / sum(var.comp)
# or
nurses_nest1 &lt;- lmer(stress ~ 1 + (1 | hospital / wardid), data = nurses)
# use same VarCorr code as above
# or 
nurses_nest2 &lt;- lme(stress ~ 1, random = ~ 1 | hospital / wardid, data = nurses)
varcomp(nurses_nest2, scale = TRUE)</code></pre>
</div>
</div>
<div id="section-decomposing-a-time-series" class="section level2">
<h2>Decomposing a time series</h2>
<p>A **time series* is simply a vector of data points that are serially
ordered in time.</p>
<p><img
src="https://www.influxdata.com/wp-content/uploads/autocorrelation-in-time-series-data-figure-5.png"
style="width:75.0%" /></p>
<p>Time series, like spatial data, are made up of three additive
components: trend, autocorrelated noise, and independent noise.</p>
<p>We will simulate each of these components separately and then add
them up to see how the three components additively combine to form a
time series.</p>
<div id="section-simulations" class="section level3">
<h3>Simulations</h3>
<p>Let’s simulate a time series with 100 data points. Independent noise
(i.e., <strong>white noise</strong>) is just uncorrelated errors sampled
from a normal distribution with <code>mean = 0</code> and
<code>sd =</code> whichever number you’d like. Use <code>rnorm()</code>
to do this. We will simulate autocorrelated noise (i.e., <strong>red
noise</strong>) with <code>arima.sim(list(ar1 = 0.8), n = 100)</code>,
where 0.8 is the strength of autocorrelation when lag = 1 (pick
whichever number you want). And lastly, the trend is just a linear model
with no noise with some intercept and slope value (the independent
variable is <code>1:n</code>). You can plot each component with
<code>plot(1:100, time_series_objectm type = "l")</code>. To combine the
components for the full time series, just add the three components
together!</p>
<div class="tutorial-exercise" data-label="ts" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button if stuck</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ts-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>n &lt;- 100

set.seed(100)
independ_noise &lt;- rnorm(100) # can pick whichever SD you want, but mean must equal 0
autocorr_noise &lt;- arima.sim(list(ar1 = 0.8), n = n) # pick whichever autocorrelation strength you want
trend &lt;- 2 + 0.5 * 1:n # my intercept is 2 and slope is 0.5 (pick whichever coefficients you want)

ts_comb &lt;- independ_noise + autocorr_noise + trend # combine the three components
plot(ts_comb, type = &quot;l&quot;) # plot with one variable just plots the data w/in that variable in order, which is fine in this case since the order is time </code></pre>
</div>
<p>These three components are also found in spatial data, but the code
for simulating them is much more complicated. So I won’t go over spatial
data here.</p>
</div>
</div>
<div id="section-detrending-a-time-series-correlograms"
class="section level2">
<h2>Detrending a time series &amp; correlograms</h2>
<p>We will analyze your simulated, combined time series from the
previous topic (copy and paste your code below!). This time series is
strongly trended because we simulated it to have a trend. Let’s remove
the trend (i.e., <strong>detrend</strong> the time series), so we’re
only left with autocorrelated noise and independent noise (the sum of
which should still have autocorrelation).</p>
<p>There are two ways to detrend a time series: (1) first differencing
and (2) fitting a trend and taking the residuals. <strong>First
differencing</strong> is done easily using <code>diff()</code>, though
it should be noted that this method removes both trend and also some
autocorrelation (we’ll see this below). The second method is done by
fitting a trend to the time series and taking residuals (e.g.,
<code>lm(ts_comb ~ c(1:100))$residuals)</code>. If the trend is more
complicated (e.g., non-linear), we can fit a lowess curve (using
<code>lowess()</code>) and then take residuals.</p>
<p>Try out both methods of detrending on your simulated time series
below.</p>
<div class="tutorial-exercise" data-label="detrend" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button if stuck</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="detrend-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code># first differencing
diff(ts_comb)

# taking residuals of fitted trend
lm.res &lt;- lm(ts_comb ~ c(1:100)) # for some reason, we need the c() or else R freaks out</code></pre>
</div>
<p>You can compare the detrended time series to the original, using
<code>plot(ts, type = "l")</code>.</p>
<p>Note that these two methods of detrending also apply to spatial data
when it is strongly trended.</p>
<div id="section-autocorrelation-function" class="section level3">
<h3>Autocorrelation function</h3>
<p>The <strong>autocorrelation function</strong> (ACF) is a type of
correlogram where correlations are calculated for a time series against
itself at different time lags. Now let’s get the ACF plot for each
detrended time series to examine the autocorrelated noise structure. To
produce the ACF plot, simply wrap <code>acf()</code> around the
detrended time series. If you save this to an object, you can enter the
object name to bring up the actual ACF values for each time lag.</p>
<div class="tutorial-exercise" data-label="acf" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>Note that first differencing removed the positive autocorrelated
noise structure (in fact it was so aggressive that there is now
<em>negative</em> autocorrelation at lag = 1). Fitting a trend and
taking residuals does not remove autocorrelation (unlike first
differencing), so we still see positive autocorrelation up to lag = 2.
Remember that this autocorrelated noise structure is combined with the
independent noise component, so the autocorrelation is attenuated
(compare this ACF to one done on just the autocorrelated noise component
from your simulations).</p>
<p>If you want to use <code>acf()</code> on real data, enter
<code>acf(presidents)</code> to get the ACF for the time series of US
president quarterly approval ratings (what I showed in lecture).</p>
</div>
<div id="section-spatial-correlogram" class="section level3">
<h3>Spatial correlogram</h3>
<p>Really quickly, let’s create a spatial correlogram for spatial data,
so you can see what the code looks like.</p>
<p>Below is autocorrelated noise I’ve simulated or you (same as in
lecture).</p>
<p><img src="Week11_files/figure-html/unnamed-chunk-4-1.png" width="624" /></p>
<div class="tutorial-exercise-support" data-label="spat_corr-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>xy &lt;- expand.grid(1:100, 1:100)
names(xy) &lt;- c(&#39;x&#39;,&#39;y&#39;)

# red noise
g.red &lt;- gstat(formula=z~1, locations=~x + y, dummy=T, beta=0, model=vgm(psill = 0.025, range = 15, model=&#39;Exp&#39;), nmax=20)

set.seed(100)
y.red &lt;- predict(g.red, newdata=xy, nsim=1)

gridded(y.red) = ~x+y</code></pre>
</div>
<p>All the relevant data is in the <code>y.red</code> dataframe, wherein
the x- and y-coordinates and variable values are <code>x</code>,
<code>y</code>, and <code>sim1</code>, respectively. The code, then, for
creating a correlogram is:
<code>correlogram(krig = surf.ls(np = 0, x = y.red$x, y= y.red$y, z=y.red$sim1), nint = 100)</code>.
Without going into details, this correlogram uses a trend surface (which
we’ve designated as flat with <code>np = 0</code>), and
<code>nint =</code> tells R how many distance bins to use. If you save
the code to an object, you can use the object name to bring up
correlogram values to have more control over plotting.</p>
<div class="tutorial-exercise" data-label="spat_corr"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>#
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
</div>
</div>
<div id="section-cross-correlograms" class="section level2">
<h2>Cross-correlograms</h2>
<p>The <strong>cross-correlation function</strong> (CCF) is a type of
cross-correlogram that quantifies how two time series are correlated
with each other at different lags. We will analyze the dataset I used in
class: climate variability vs. mammalian extinction rates from the
Plio-Pleistocene of eastern Africa. The dataframe is called
<code>d</code>, and it contains the age (<code>age_Ma</code>), climate
variability measure (<code>clim.var</code>), and extinction rates
(<code>ext.rates</code>). You can plot both time series below if you’d
like.</p>
<div class="tutorial-exercise-support" data-label="cross_corr-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>clim_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/climVar_extRates.csv&quot;)
d &lt;- read.csv(text = clim_url)</code></pre>
</div>
<div class="tutorial-exercise" data-label="cross_corr"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>#
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>To create a CCF, simply enter
<code>ccf(d$clim.var, d$ext.rates)</code>. Negative lags are where
climate variability is older, and positive lags are the opposite. As
before, you can save the <code>ccf()</code> results to an object to get
the actual CCF estimates.</p>
<div id="section-spatial-cross-correlogram" class="section level3">
<h3>Spatial cross-correlogram</h3>
<p>As with the previous topic, I will quickly go over the spatial
counter part of cross-correlograms, just to show you the code.</p>
<p>Below are maps of samples taken from the floodplain of the Meuse
river in the Netherlands. Each sample has a measured organic matter and
cadmium level.</p>
<p><img src="Week11_files/figure-html/unnamed-chunk-5-1.png" width="624" /><img src="Week11_files/figure-html/unnamed-chunk-5-2.png" width="624" /></p>
<p>To create the cross-correlogram, I’ve included the proper code in the
console below (this might take a little bit depending on how fast your
computer is). Within the <code>correlog()</code> function,
<code>x</code> and <code>y</code> are the coordinates, <code>om</code>
and <code>cadmium</code> are organic matter and cadmium levels, and
<code>increment =</code> tells R how many distance bins to use. You can
add a solid horizontal line with <code>abline(h = 0)</code>.</p>
<div class="tutorial-exercise-support" data-label="spat_cross-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>data(meuse)</code></pre>
</div>
<div class="tutorial-exercise" data-label="spat_cross"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>plot(correlog(x = meuse$x, y = meuse$y, z = meuse$om, w = meuse$cadmium, increment = 100, na.rm = TRUE))
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
</div>
</div>
<div id="section-generalized-least-squares" class="section level2">
<h2>Generalized least squares</h2>
<p><strong>Generalized least squares</strong> (GLS) models a DV as a
linear function of one or more IVs, while relaxing the independent
errors assumption of GLMs. It relaxes this assumption by explicitly
modeling the non-independent error structure with one or more estimated
parameters. All parameters are estimated using maximum likelihood.</p>
<p>We will analyze the <code>hawaii</code> dataset, which I’ve
pre-loaded. Specifically, we will model the square-root transformed
abundance of <code>Moorhen.Kauai</code> as a function of
<code>Year</code> and <code>Rainfall</code> (no interaction).
<code>Moorhen.Kauai ~ Year</code> assesses whether abundance changes
linearly through time, while <code>Moorhen.Kauai ~ Rainfall</code>
assesses whether abundance changes as a linear function of rainfall.
Feel free to plot the data (e.g., as time series, scatter plots) to see
what it looks like.</p>
<div class="tutorial-exercise-support" data-label="gls-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>hawaii_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/Hawaii.txt&quot;)
hawaii &lt;- read.table(text = hawaii_url, header = TRUE, sep = &quot;\t&quot;)</code></pre>
</div>
<p>We will compare the results using <code>lm()</code>
vs. <code>gls()</code>. So go ahead and fit a multiple regression using
<code>lm()</code>. Then do the same using <code>gls()</code>. This
function requires two additional arguments:
<code>correlation = corAR1(form = ~Year)</code> and
<code>na.action = na.omit</code>. The first argument tells R to model
the autocorrelated errors using an AR1 structure
(<code>form = ~Year</code> tells R that <code>Year</code> is a time IV;
otherwise time would correspond to the order of observations). That is,
<code>gls()</code> will estimate a parameter, <span
class="math inline">\(\rho\)</span>, which is the correlation between
errors one time step apart. <span class="math inline">\(\rho ^
2\)</span> is the correlation between errors two time steps apart, <span
class="math inline">\(\rho ^ 3\)</span> is the correlation between
errors three time steps apart, etc. The second argument in
<code>gls()</code> tells R to delete <code>NA</code>, something
<code>lm()</code> does automatically.</p>
<div class="tutorial-exercise" data-label="gls" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button if stuck
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="gls-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>lm.res &lt;- lm(sqrt(Moorhen.Kauai) ~ Year + Rainfall, data = hawaii)

gls.res &lt;- gls(sqrt(Moorhen.Kauai) ~ Year + Rainfall, data = hawaii, correlation = corAR1(form = ~Year), na.action = na.omit)

acf(lm.res$residuals)

acf(resid(gls.res, type = &quot;normalized&quot;))</code></pre>
</div>
<p>First note the high value for estimated <span
class="math inline">\(\rho\)</span>, illustrating that there’s strong
autocorrelation in the errors.</p>
<p>Now compare the coefficients and P-values between GLM and GLS. As you
can see, the coefficients are fairly similar, and the significant
P-values in GLM are smaller than their counterparts in GLS. This is to
be expected: the non-independent errors will decrease P-values and
increase Type I error rate in GLM. When the non-independent errors are
accounted for, the P-values will increase to their “proper” values,
though they’re still significant in this case. The takeaway here is that
GLM coefficient estimates are unbiased, even in the face of
autocorrelated errors. So if you only care about coefficient estimates
and not P-values, just go ahead and use <code>lm()</code>!</p>
<p>Now plot the ACFs of the residuals from both models. For the
<code>gls()</code> results, you have to extract residuals using
<code>resid()</code> with argument <code>type = "normalized"</code>.
Otherwise, the residuals will not be corrected using the estimated <span
class="math inline">\(\rho\)</span> parameter.</p>
<p>As you can see, the GLM residuals still show positive autocorrelation
at lag = 1. This autocorrelation disappears in GLS, as to be expected
(since the autocorrelation is modeled and removed).</p>
<p>For spatial data, errors are modeled using five models:</p>
<ol style="list-style-type: decimal">
<li>Exponential (<code>corExp</code>)</li>
<li>Gaussian (<code>corGaus</code>)</li>
<li>Linear (<code>corLin</code>)</li>
<li>Rational quadratic (<code>corRatio</code>)</li>
<li>Spherical (<code>corSpher</code>)</li>
</ol>
<div class="figure">
<img
src="https://github.com/andrewdu1/ANTH674/blob/master/Datasets/Spatial%20autocorrelation%20error%20models.jpg?raw=true"
style="width:75.0%" alt="" />
<p class="caption">The five common spatial autocorrelation error models.
Different parameterizations will change each model’s curve slightly.
Ignore the vertical lines and x’s.</p>
</div>
<p>These models are entered into the <code>correlation =</code> argument
in <code>gls()</code>, just like we did with <code>corAR1</code>.</p>
</div>
<div id="section-accounting-for-autocorrelated-errors-using-an-iv"
class="section level2">
<h2>Accounting for autocorrelated errors using an IV</h2>
<p>Autocorrelated errors can be accounted for by including an IV that
has the same autocorrelation structure. In other words, the
autocorrelation in the errors can be modeled by the IV, thereby
producing errors that are independent. For example, an herbivore
species’ abundance is autocorrelated because it follows plant
distribution, which itself is autocorrelated; if one models herbivore
abundance as a function of plant distribution, then the autocorrelation
in herbivore is explained by plant, thus producing independent errors.
If model errors are independent, then this GLM assumption is satisfied,
and P-values will be “normal” (no need for any correction!).</p>
<p>Let’s see an example of this, using the example I used in lecture.
Below are spatial correlograms for an index of wetness and number of
boreal tree species. As you can see, the autocorrelation structures are
very similar, implying that spatial distribution of wetness affects
distribution of boreal species (or both are affected by some third
variable).</p>
<p><img src="Week11_files/figure-html/unnamed-chunk-6-1.png" width="624" /><img src="Week11_files/figure-html/unnamed-chunk-6-2.png" width="624" /></p>
<p>Now create a linear model, using <code>lm()</code>, where
<code>boreal ~ Wet</code> (the dataframe is called
<code>Boreality</code>). Then create a spatial correlogram of the
residuals, using
<code>correlogram(surf.ls(0, Boreality$x, Boreality$y, lm.res$residuals), nint = 300)</code>.</p>
<div class="tutorial-exercise-support" data-label="bor-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>boreal_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/Boreality.txt&quot;)
Boreality &lt;- read.table(text = boreal_url, header = TRUE, sep = &quot;\t&quot;)</code></pre>
</div>
<div class="tutorial-exercise" data-label="bor" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code>#
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<p>As you can see, there is still some leftover positive autocorrelation
in the residuals, but the distance at which autocorrelation persists has
drastically decreased. Thus, the autocorrelation in <code>boreal</code>
has been mostly accounted for by the similar autocorrelation structure
in <code>wetness</code>, leaving less autocorrelation in the
<code>lm()</code> residuals.</p>
</div>
<div id="section-exercise-2" class="section level2">
<h2>Exercise 2</h2>
<ol style="list-style-type: decimal">
<li><p>For this question, we will work with the <code>co2</code> time
series (see the help file for more details). First plot the time series
with <code>plot(co2)</code>. Then detrend the data by fitting a linear
model and then taking residuals (because the time series has equally
spaced data points, you can transform this into a <code>numeric</code>
class first and then model it as a function of
<code>c(1:length(co2))</code>). Lastly, create an autocorrelation
function plot of the detrended time series.</p></li>
<li><p>Now we will work with two time series: <code>mdeaths</code> and
<code>fdeaths</code> (see their help file for more info about the data).
First plot each time series. Then create a cross-correlation function
plot.</p></li>
<li><p>Let’s analyze the <code>hawaii</code> dataset again and see if
another bird species shows a more noticeable relationship with
<code>rainfall</code>. Fit a generalized least squares model with
<code>sqrt(sqrt(Stilt.Maui))</code> (i.e., a double square-root
transformation) as a function of <code>Year</code> and
<code>Rainfall</code>. Make sure to specify that the autocorrelation
structure is <code>corAR1()</code> as a function of <code>Year</code>.
Then create a ACF plot of the residuals, making sure to use the
residuals that have been GLS-corrected for autocorrelation.</p></li>
</ol>
<div class="tutorial-exercise-support" data-label="exer2-setup"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code>hawaii_url &lt;- RCurl::getURL(&quot;https://raw.githubusercontent.com/andrewdu1/ANTH674/master/Datasets/Hawaii.txt&quot;)
hawaii &lt;- read.table(text = hawaii_url, header = TRUE, sep = &quot;\t&quot;)</code></pre>
</div>
<div class="tutorial-exercise" data-label="exer2" data-caption="Code"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0">
<pre class="text"><code># Click &quot;Solution&quot; button when done
#
#
#
#</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="exer2-solution"
data-caption="Code" data-completion="1" data-diagnostics="1"
data-startover="1" data-lines="0">
<pre class="text"><code># Q1
plot(co2)
lm.res &lt;- lm(as.numeric(co2) ~ c(1:length(co2)))
acf(lm.res$residuals)
# there is strong positive autocorrelation and cyclicity in the data (as can be seen in the original time series)

# Q2
plot(mdeaths)
plot(fdeaths)
ccf(mdeaths, fdeaths) # there is strong cyclicity as to be expected from the original time series. Also, the time series are in phase at lags of -1, 0, and 1, and out of phase at lags of -0.5 and 0.5

# Q3
gls.res &lt;- gls(sqrt(sqrt(Stilt.Maui)) ~ Year + Rainfall, data = hawaii, correlation = corAR1(form = ~Year))
acf(resid(gls.res, type = &quot;normalized&quot;))</code></pre>
</div>
</div>
<div id="section-conclusion" class="section level2">
<h2>Conclusion</h2>
<p>We took a leap into some fairly complicated concepts and methods this
week, so if you understood at least 50% of the lecture and tutorial
material, you should feel very proud!</p>
<p>Linear mixed models are becoming more common in (biological)
anthropology, though there’s a good chance they’re misused and
misunderstood. Here, we covered the fundamentals of LMMs and learned
what random factors are and when to use them:</p>
<ol style="list-style-type: decimal">
<li>if we’re interested in estimating the SD of intercepts and/or slopes
across levels</li>
<li>if our sample size is too small</li>
<li>if we want to use shrinkage/regularization to shrink estimates
towards the population mean</li>
<li>if we want to account for non-independence using blocking</li>
<li>if we want to partition variance among the random factors.</li>
</ol>
<p>We then learned about non-independence (i.e., autocorrelation) in a
more nuanced way. Autocorrelation is often thought of as a nuisance that
needs to be corrected for in statistics. I, however, prefer to think of
autocorrelation as interesting structure in the data that can tell us
something about the processes that generated the observed patterns. We
can measure and quantify autocorrelation using correlograms (for
temporal, spatial, and even phylogenetic data). We then learned how to
quantify the association between two variables in time and space using
cross-correlograms (cf. correlation) and generalized least squares
(cf. linear models). It is important to keep in mind that autocorrelated
model errors can be eliminated by including the proper IV. And even if
errors are autocorrelated, coefficient estimates are unbiased and only
P-values are affected (they’re biased downward).</p>
<p>Hopefully, this week’s lecture and tutorial have given you enough
fundamentals, so you can begin to explore LMMs and autocorrelation in
your own research. We have only scratched the surface, so there’s much
more to learn on your own! 
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
library(knitr)
library(nlme)
library(lme4)
library(ape)
library(lattice)
library(gstat)
library(sp)
library(spatial)
library(ncf)

knitr::opts_chunk$set(echo = TRUE)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-intercept-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-intercept-code-editor`)), session)
output$`tutorial-exercise-intercept-output` <- renderUI({
  `tutorial-exercise-intercept-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-slope-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-slope-code-editor`)), session)
output$`tutorial-exercise-slope-output` <- renderUI({
  `tutorial-exercise-slope-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ancova-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ancova-code-editor`)), session)
output$`tutorial-exercise-ancova-output` <- renderUI({
  `tutorial-exercise-ancova-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-shrink-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-shrink-code-editor`)), session)
output$`tutorial-exercise-shrink-output` <- renderUI({
  `tutorial-exercise-shrink-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-cross-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-cross-code-editor`)), session)
output$`tutorial-exercise-cross-output` <- renderUI({
  `tutorial-exercise-cross-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-nest-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-nest-code-editor`)), session)
output$`tutorial-exercise-nest-output` <- renderUI({
  `tutorial-exercise-nest-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-exer1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-exer1-code-editor`)), session)
output$`tutorial-exercise-exer1-output` <- renderUI({
  `tutorial-exercise-exer1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ts-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ts-code-editor`)), session)
output$`tutorial-exercise-ts-output` <- renderUI({
  `tutorial-exercise-ts-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-detrend-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-detrend-code-editor`)), session)
output$`tutorial-exercise-detrend-output` <- renderUI({
  `tutorial-exercise-detrend-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-acf-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-acf-code-editor`)), session)
output$`tutorial-exercise-acf-output` <- renderUI({
  `tutorial-exercise-acf-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-spat_corr-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-spat_corr-code-editor`)), session)
output$`tutorial-exercise-spat_corr-output` <- renderUI({
  `tutorial-exercise-spat_corr-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-cross_corr-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-cross_corr-code-editor`)), session)
output$`tutorial-exercise-cross_corr-output` <- renderUI({
  `tutorial-exercise-cross_corr-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-spat_cross-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-spat_cross-code-editor`)), session)
output$`tutorial-exercise-spat_cross-output` <- renderUI({
  `tutorial-exercise-spat_cross-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-gls-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-gls-code-editor`)), session)
output$`tutorial-exercise-gls-output` <- renderUI({
  `tutorial-exercise-gls-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-bor-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-bor-code-editor`)), session)
output$`tutorial-exercise-bor-output` <- renderUI({
  `tutorial-exercise-bor-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-exer2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-exer2-code-editor`)), session)
output$`tutorial-exercise-exer2-output` <- renderUI({
  `tutorial-exercise-exer2-result`()
})
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.14"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.14"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66]}},"value":[{"type":"character","attributes":{},"value":["ape","base","bitops","boot","bslib","cli","compiler","datasets","digest","ellipsis","evaluate","fastmap","FNN","graphics","grDevices","grid","gstat","highr","htmltools","htmlwidgets","httpuv","intervals","jquerylib","jsonlite","knitr","later","lattice","learnr","lifecycle","lme4","magrittr","markdown","MASS","Matrix","methods","mime","minqa","ncf","nlme","nloptr","parallel","promises","R6","Rcpp","RCurl","rlang","rmarkdown","rprojroot","rstudioapi","sass","shiny","sp","spacetime","spatial","splines","stats","stringi","stringr","tools","utils","withr","xfun","xtable","xts","yaml","zoo"]},{"type":"character","attributes":{},"value":["5.6-2","4.2.1","1.0-7","1.3-28","0.3.1","3.3.0","4.2.1","4.2.1","0.6.29","0.3.2","0.15","1.1.0","1.1.3.1","4.2.1","4.2.1","4.2.1","2.0-9","0.9","0.5.2","1.5.4","1.6.5","0.15.2","0.1.4","1.8.0","1.39","1.3.0","0.20-45","0.10.1","1.0.1","1.1-30","2.0.3","1.1","7.3-57","1.5-1","4.2.1","0.12","1.2.4","1.3-2","3.1-157","2.0.3","4.2.1","1.2.0.1","2.5.1","1.0.8.3","1.98-1.8","1.0.2","2.14","2.0.3","0.13","0.4.1","1.7.1","1.4-7","1.2-8","7.3-15","4.2.1","4.2.1","1.7.6","1.4.1","4.2.1","4.2.1","2.5.0","0.30","1.8-4","0.12.1","2.3.5","1.8-10"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">Mixed models and
autocorrelation</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
